---
import RedoIcon from '~icons/bx/share'
import { shareButton } from './ShareButton.css'
interface Props {
	shareData: any
}

const { shareData } = Astro.props
---

<share-button class={shareButton} data-shareData={JSON.stringify(shareData)}><RedoIcon /> SHARE </share-button>

<script>
	class ShareButton extends HTMLElement {
		shareData

		constructor() {
			super()
			if (!this.dataset.shareData) return
			this.shareData = JSON.parse(this.dataset.shareData)
		}

		connectedCallback() {
			this.addEventListener('click', () => {
				try {
					navigator.share(this.shareData)
				} catch {
					console.error('Something went wrong.')
				}
			})
		}
	}

	customElements.define('share-button', ShareButton)
</script>
